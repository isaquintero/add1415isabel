<html>
<head>
	<meta charset="UTF-8">
	<title>T&iacute;tulo del trabajo</title>
</head>
<body>
<div style='display:table-row; padding: 10px;'>
  <div style='float: left; width=20%; padding:10px;'>
  <img src='./files/logo.png'/>
  </div>
  <div style='float: left;padding:10px'>
  <ul>
    <li><b>M&oacute;dulo:</b> <i>Administración de Sistemas Operativos</i></li>
    <li><b>T&iacute;tulo del trabajo</b> <i>Generar Usuarios.</i></li>
    <li><b>Componentes del grupo:</b> <i>Isabel Quintero Sánchez.</i></li>
    <li><b>Curso Acad&eacute;mico:</b> <i>2014/2015</i></li>
    <li><b>Fecha de entrega:</b> <i>2 de Marzo de 2015</i></li>
  </ul>
  </div>
</div>
<div style='float: clear;background-color: #eeeeee; border:2px solid; border-radius:10px; padding: 10px;'>
<a href='#bloque1'>Instalación y Configuración.</a> | <a href='#bloque2'>Manos a la Obra.</a> 
</div>


<h1><a id='bloque1'>Instalación y Configuración.</a></h1>

<p>Para esta parte de la práctica utilizaremos una MV Windows 2008 Server, donde realizaremos paso a paso lo que nos indica el enunciado.</p>


<p>En primer lugar, vamos al enlace que nos proporciona el documento del profesor para descargarnos GAWK y procdemos a su instalación.</p>

  <img src='./files/2.png'/>
  
  <p>Una vez instalado, nos asegurarnos de que podemos ejecutarlo desde cualquier directorio del sistema de ficheros de Windows, para ello debemos establecer la variable de entorno
%PATH% siguiendo la ruta <i>Inicio > Equipo > Propiedades:</i></p>
  
    <img src='./files/1.png'/>
    
<h3>Editar permisos en particiones NTFS en Windows Server con XCALCS.vbs.</h3>
    
<p>XCACLS.vbs es un script que nos permite, ver, modificar y eliminar permisos NTFS en Windows. Lo primero que debemos hacer es descargar el script desde el enlace que nos proporciona 
el documento de el profesor. Una vez descargado el programa, debemos ejecutar el instalador y extraer todos los archivos en la carpeta donde tenemos instalado el S.O, en este caso C:\Windows..</p>
	<img src='./files/3.png'/>

<p>Luego, buscamos la function "IsOsSupported()" y la editamos para que soporte la versión 6.0 (Windows Server2008) y 6.1 (Windows Server 2008 R2)</p>	
	<img src='./files/4.png'/>
	

<p>Luego cambiaremos el motor de secuencias de comandos predeterminado, de WSCRIPT a CSCRIPT, esto se debe a que XCACLS.vbs trabaja mejor con cscript. Así que escribiremos el siguiente comando en
"Ejecutar...": <b>cscript.exe /h:cscript</b>.</p>
	<img src='./files/5.png'/>


<p>Para utilizar el script, debemos abrir una nueva consola de línea de comandos e ir hasta el directorio "C:\WINDOWS" y ejecutar <b>cscript.exe xcacls.vbs</b>.</p>
	<img src='./files/6.png'/>
	
<h1><a id='bloque2'>Manos a la Obra..</a></h1>

<h3>Creación del fichero CSV.</h3>

<p>Abriremos el bloc de notas o cualquier otro editor de texto y copiaremos todos los datos que nos proporciona el documento de la práctica, dicho ducmento lo guardaremos como
"usuarios.csv".</p>

<img src='./files/8.png'/>

<h3>Creación del fichero AWK.</h3>

<p>Volvemos a abrir el bloc de notas u otro editor de texto y copiamos lo que nos proporciona el documento de la práctica, en este caso lo llamaremos "alta.awk".</p>
<img src='./files/9.png'/>

<p>Debemos instalar la función de Active Directory y crear un nuevo bosque.</p>
<img src='./files/10.png'/>

<p>Para que no nos de error, también debemos crear la Unidad Organizativa de "Formación profesional" manualmente.</p>

<img src='./files/14.png'/>

<h3>Modo de ejecución.</h3>

<p>Para acabar, debemos generar el fichero "crear.bat" con los dos ficheros creados anteriormente (alta.awk y usuarios.csv). Para ello, debemos ir a la ruta donde hemos guardado los ficheros y que hemos 
puesto en el Path "C:\ProgramFiles(86)\GnuWin32\bin" y ejecutar el siguiente comando: <b>awk -f alta.aek usuarios.csv</b>.</p>
<img src='./files/13.png'/>

<p>Observamos que el fichero "crear.bat" se ha creado correctamenta y procedemos a su ejecución.</p>

<img src='./files/15.png'/>
<img src='./files/16.png'/>
</body>
</html>
